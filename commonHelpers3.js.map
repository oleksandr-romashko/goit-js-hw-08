{"version":3,"file":"commonHelpers3.js","sources":["../src/js/03-feedback.js"],"sourcesContent":["import throttle from 'lodash.throttle';\n\nconst LS_FORM_DATA_KEY = 'feedback-form-state';\n\nconst form = document.querySelector('.feedback-form');\n\nconst storageData = JSON.parse(localStorage.getItem(LS_FORM_DATA_KEY)) ?? {};\nif (Object.keys(storageData).length) {\n  [...form.elements].forEach(el => {\n    if (storageData[el.name]) {\n      el.value = storageData[el.name];\n    }\n  });\n}\n\nform.addEventListener('input', throttle(onInput, 500));\nform.addEventListener('submit', onFormSubmit);\n\n/**\n * * Retrieves values from form fields.\n * @returns {object} Feefback form fields data.\n */\nfunction getFormData() {\n  const formData = {};\n  [...form.elements].forEach(({ nodeName, name, value }) => {\n    if (nodeName !== 'BUTTON' && value) {\n      formData[name] = value;\n    }\n  });\n  return formData;\n}\n\n/**\n * * Handles input event and invokes saving form values to local storage.\n * * If all form fields are emptied by user, clear up local storage.\n */\nfunction onInput() {\n  const formData = getFormData();\n  Object.keys(formData).length ? saveToStorage(formData) : clearStorage();\n}\n\n/**\n * * Handles feedback form submit.\n * @param {Event} event Occured event.\n */\nfunction onFormSubmit(event) {\n  event.preventDefault();\n  console.log(getFormData());\n  form.reset();\n  clearStorage();\n}\n\n/**\n * * Saves feedback data to local storage.\n * @param {object} data data to sage.\n */\nfunction saveToStorage(data) {\n  localStorage.setItem(LS_FORM_DATA_KEY, JSON.stringify(data));\n}\n\n/**\n * * Removes feedback data from local storage.\n */\nfunction clearStorage() {\n  localStorage.removeItem(LS_FORM_DATA_KEY);\n}\n"],"names":["LS_FORM_DATA_KEY","form","storageData","el","throttle","onInput","onFormSubmit","getFormData","formData","nodeName","name","value","saveToStorage","clearStorage","event","data"],"mappings":"wIAEA,MAAMA,EAAmB,sBAEnBC,EAAO,SAAS,cAAc,gBAAgB,EAE9CC,EAAc,KAAK,MAAM,aAAa,QAAQF,CAAgB,CAAC,GAAK,GACtE,OAAO,KAAKE,CAAW,EAAE,QAC3B,CAAC,GAAGD,EAAK,QAAQ,EAAE,QAAQE,GAAM,CAC3BD,EAAYC,EAAG,IAAI,IACrBA,EAAG,MAAQD,EAAYC,EAAG,IAAI,EAEpC,CAAG,EAGHF,EAAK,iBAAiB,QAASG,EAASC,EAAS,GAAG,CAAC,EACrDJ,EAAK,iBAAiB,SAAUK,CAAY,EAM5C,SAASC,GAAc,CACrB,MAAMC,EAAW,CAAA,EACjB,OAAC,GAAGP,EAAK,QAAQ,EAAE,QAAQ,CAAC,CAAE,SAAAQ,EAAU,KAAAC,EAAM,MAAAC,KAAY,CACpDF,IAAa,UAAYE,IAC3BH,EAASE,CAAI,EAAIC,EAEvB,CAAG,EACMH,CACT,CAMA,SAASH,GAAU,CACjB,MAAMG,EAAWD,IACjB,OAAO,KAAKC,CAAQ,EAAE,OAASI,EAAcJ,CAAQ,EAAIK,GAC3D,CAMA,SAASP,EAAaQ,EAAO,CAC3BA,EAAM,eAAc,EACpB,QAAQ,IAAIP,EAAW,CAAE,EACzBN,EAAK,MAAK,EACVY,GACF,CAMA,SAASD,EAAcG,EAAM,CAC3B,aAAa,QAAQf,EAAkB,KAAK,UAAUe,CAAI,CAAC,CAC7D,CAKA,SAASF,GAAe,CACtB,aAAa,WAAWb,CAAgB,CAC1C"}