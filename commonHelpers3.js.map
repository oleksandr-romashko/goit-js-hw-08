{"version":3,"file":"commonHelpers3.js","sources":["../src/js/03-feedback.js"],"sourcesContent":["import throttle from 'lodash.throttle';\n\nconst LS_FORM_VALUES_KEY = 'feedback-form-state';\n\nconst form = document.querySelector('.feedback-form');\n\nform.addEventListener('input', throttle(onFormInput, 500));\nform.addEventListener('submit', onFormSubmit);\n\ninit();\n\nfunction init() {\n  let storageValues = loadValuesFromStorage();\n  if (!storageValues) {\n    return;\n  }\n\n  [...form.elements].forEach(el => {\n    const storageValue = storageValues[el.name];\n    if (storageValue) {\n      el.value = storageValue;\n    }\n  });\n}\n\nfunction onFormInput() {\n  const formValues = readFormValues();\n  Object.keys(formValues).length\n    ? saveValuesToStorage(formValues)\n    : clearStorage();\n}\n\nfunction onFormSubmit(event) {\n  event.preventDefault();\n  const values = loadValuesFromStorage();\n  clearStorage();\n  form.reset();\n  console.log(values);\n}\n\nfunction readFormValues() {\n  const formValues = {};\n  [...form.elements].forEach(({ nodeName, name, value }) => {\n    if (\n      value.trim().replace('\\n', '') &&\n      (nodeName == 'INPUT' || nodeName == 'TEXTAREA')\n    ) {\n      formValues[name] = value;\n    }\n  });\n  return formValues;\n}\n\nfunction loadValuesFromStorage() {\n  return JSON.parse(localStorage.getItem(LS_FORM_VALUES_KEY));\n}\n\nfunction saveValuesToStorage(values) {\n  localStorage.setItem(LS_FORM_VALUES_KEY, JSON.stringify(values));\n}\nfunction clearStorage() {\n  localStorage.removeItem(LS_FORM_VALUES_KEY);\n}\n"],"names":["LS_FORM_VALUES_KEY","form","throttle","onFormInput","onFormSubmit","init","storageValues","loadValuesFromStorage","el","storageValue","formValues","readFormValues","saveValuesToStorage","clearStorage","event","values","nodeName","name","value"],"mappings":"wIAEA,MAAMA,EAAqB,sBAErBC,EAAO,SAAS,cAAc,gBAAgB,EAEpDA,EAAK,iBAAiB,QAASC,EAASC,EAAa,GAAG,CAAC,EACzDF,EAAK,iBAAiB,SAAUG,CAAY,EAE5CC,IAEA,SAASA,GAAO,CACd,IAAIC,EAAgBC,IACfD,GAIL,CAAC,GAAGL,EAAK,QAAQ,EAAE,QAAQO,GAAM,CAC/B,MAAMC,EAAeH,EAAcE,EAAG,IAAI,EACtCC,IACFD,EAAG,MAAQC,EAEjB,CAAG,CACH,CAEA,SAASN,GAAc,CACrB,MAAMO,EAAaC,IACnB,OAAO,KAAKD,CAAU,EAAE,OACpBE,EAAoBF,CAAU,EAC9BG,GACN,CAEA,SAAST,EAAaU,EAAO,CAC3BA,EAAM,eAAc,EACpB,MAAMC,EAASR,IACfM,IACAZ,EAAK,MAAK,EACV,QAAQ,IAAIc,CAAM,CACpB,CAEA,SAASJ,GAAiB,CACxB,MAAMD,EAAa,CAAA,EACnB,OAAC,GAAGT,EAAK,QAAQ,EAAE,QAAQ,CAAC,CAAE,SAAAe,EAAU,KAAAC,EAAM,MAAAC,KAAY,CAEtDA,EAAM,KAAM,EAAC,QAAQ;AAAA,EAAM,EAAE,IAC5BF,GAAY,SAAWA,GAAY,cAEpCN,EAAWO,CAAI,EAAIC,EAEzB,CAAG,EACMR,CACT,CAEA,SAASH,GAAwB,CAC/B,OAAO,KAAK,MAAM,aAAa,QAAQP,CAAkB,CAAC,CAC5D,CAEA,SAASY,EAAoBG,EAAQ,CACnC,aAAa,QAAQf,EAAoB,KAAK,UAAUe,CAAM,CAAC,CACjE,CACA,SAASF,GAAe,CACtB,aAAa,WAAWb,CAAkB,CAC5C"}