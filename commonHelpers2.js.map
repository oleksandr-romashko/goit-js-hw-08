{"version":3,"file":"commonHelpers2.js","sources":["../src/js/02-video.js"],"sourcesContent":["import Player from '@vimeo/player';\nimport throttle from 'lodash.throttle';\n\nconst VIDEO_PLAYER_CURRENT_TIME_KEY = 'videoplayer-current-time';\nlet currentVideoId;\n\nconst player = new Player('vimeo-player');\n\nplayer.on('loaded', onLoaded);\nplayer.on('timeupdate', throttle(onSaveCurrentTime, 1000, { trailing: false }));\nplayer.on('pause', onSaveCurrentTime);\nplayer.on('ended', onResetPlaybackTime);\n\nfunction onLoaded({ id }) {\n  currentVideoId = id;\n  const currentTime = getPlaybackTime(id);\n  player\n    .setCurrentTime(currentTime)\n    .catch(error => onPlayerSetTimeError(error, currentTime));\n}\n\nfunction onSaveCurrentTime({ seconds }) {\n  saveTimeToStorage(seconds);\n}\n\nfunction onResetPlaybackTime() {\n  saveTimeToStorage(0);\n}\n\nfunction onPlayerSetTimeError(error, time) {\n  switch (error.name) {\n    case 'RangeError': {\n      console.error(\n        'RangeError:\\n' +\n          `Stored video playback time is set to '${time}' seconds.\\n` +\n          'The time is less than 0 or greater than the videoâ€™s duration.'\n      );\n      onResetPlaybackTime();\n      break;\n    }\n    default: {\n      console.error(error);\n      break;\n    }\n  }\n}\n\nfunction getPlaybackTime(id) {\n  const playbacks = getStoredPlaybacks();\n  return playbacks[id] ?? 0;\n}\n\nfunction saveTimeToStorage(time) {\n  const playbacks = getStoredPlaybacks();\n  playbacks[currentVideoId] = time;\n  localStorage.setItem(\n    VIDEO_PLAYER_CURRENT_TIME_KEY,\n    JSON.stringify({ [currentVideoId]: time })\n  );\n}\n\nfunction getStoredPlaybacks() {\n  return JSON.parse(localStorage.getItem(VIDEO_PLAYER_CURRENT_TIME_KEY)) ?? {};\n}\n"],"names":["VIDEO_PLAYER_CURRENT_TIME_KEY","currentVideoId","player","Player","onLoaded","throttle","onSaveCurrentTime","onResetPlaybackTime","id","currentTime","getPlaybackTime","error","onPlayerSetTimeError","seconds","saveTimeToStorage","time","getStoredPlaybacks","playbacks"],"mappings":"+IAGA,MAAMA,EAAgC,2BACtC,IAAIC,EAEJ,MAAMC,EAAS,IAAIC,EAAO,cAAc,EAExCD,EAAO,GAAG,SAAUE,CAAQ,EAC5BF,EAAO,GAAG,aAAcG,EAASC,EAAmB,IAAM,CAAE,SAAU,EAAO,CAAA,CAAC,EAC9EJ,EAAO,GAAG,QAASI,CAAiB,EACpCJ,EAAO,GAAG,QAASK,CAAmB,EAEtC,SAASH,EAAS,CAAE,GAAAI,GAAM,CACxBP,EAAiBO,EACjB,MAAMC,EAAcC,EAAgBF,CAAE,EACtCN,EACG,eAAeO,CAAW,EAC1B,MAAME,GAASC,EAAqBD,EAAOF,CAAW,CAAC,CAC5D,CAEA,SAASH,EAAkB,CAAE,QAAAO,GAAW,CACtCC,EAAkBD,CAAO,CAC3B,CAEA,SAASN,GAAsB,CAC7BO,EAAkB,CAAC,CACrB,CAEA,SAASF,EAAqBD,EAAOI,EAAM,CACzC,OAAQJ,EAAM,KAAI,CAChB,IAAK,aAAc,CACjB,QAAQ,MACN;AAAA,wCAC2CI,CAAI;AAAA,8DAEvD,EACMR,IACA,KACD,CACD,QAAS,CACP,QAAQ,MAAMI,CAAK,EACnB,KACD,CACF,CACH,CAEA,SAASD,EAAgBF,EAAI,CAE3B,OADkBQ,IACDR,CAAE,GAAK,CAC1B,CAEA,SAASM,EAAkBC,EAAM,CAC/B,MAAME,EAAYD,IAClBC,EAAUhB,CAAc,EAAIc,EAC5B,aAAa,QACXf,EACA,KAAK,UAAU,CAAE,CAACC,CAAc,EAAGc,CAAI,CAAE,CAC7C,CACA,CAEA,SAASC,GAAqB,CAC5B,OAAO,KAAK,MAAM,aAAa,QAAQhB,CAA6B,CAAC,GAAK,EAC5E"}